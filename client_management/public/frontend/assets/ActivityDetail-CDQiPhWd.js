var C=(D,v,d)=>new Promise((r,u)=>{var p=o=>{try{_(d.next(o))}catch(n){u(n)}},m=o=>{try{_(d.throw(o))}catch(n){u(n)}},_=o=>o.done?r(o.value):Promise.resolve(o.value).then(p,m);_((d=d.apply(D,v)).next())});import{r as y,A as F,q as S,a as i,d as f,w as h,u as g,i as x,t as a,b as e,F as V,k as E,a9 as L,e as $,c as w,o as c,g as b,l as I,ad as R}from"./index-CK1KYSDl.js";const M={class:"max-w-4xl mx-auto p-6"},O={key:0,class:"text-center py-8"},P={key:1,class:"mb-4 p-4 bg-red-100 text-red-700 rounded-md"},j={key:2,class:"space-y-6"},q={class:"bg-white rounded-lg shadow p-6"},G={class:"flex justify-between items-start"},U={class:"text-2xl font-semibold"},z={class:"flex items-center mt-2 space-x-4 text-sm text-gray-600"},H={class:"mt-4 grid grid-cols-2 gap-4"},J={class:"mt-1 text-sm text-gray-900"},K={key:0},Q={class:"mt-1 text-sm text-gray-900"},W={class:"bg-white rounded-lg shadow overflow-hidden"},X={class:"overflow-x-auto"},Y={class:"min-w-full divide-y divide-gray-200"},Z={class:"bg-white divide-y divide-gray-200"},ee={class:"px-6 py-4 whitespace-nowrap"},te={class:"text-sm font-medium text-gray-900"},se={key:0,class:"text-sm text-gray-500 mt-1"},ae={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},re={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},oe={class:"px-6 py-4 whitespace-nowrap"},ie={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ce={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},le={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ne={key:0,class:"p-8 text-center text-gray-500"},_e={__name:"ActivityDetail",setup(D){const v=L(),d=$(),r=y(null),u=y([]),p=y(!0),m=y(""),_=y(""),o=F(()=>_.value==="Client"?u.value.filter(s=>!s.hide_to_client):u.value),n=l=>new Date(l).toLocaleDateString(),N=l=>{switch(l){case"Completed":return"green";case"In Progress":return"blue";case"Overdue":return"red";default:return"gray"}},T=()=>C(this,null,function*(){var l;p.value=!0,m.value="";try{const t=yield w({url:"frappe.auth.get_logged_user"}).fetch(),A=yield w({url:"frappe.client.get_value",params:{doctype:"User",fieldname:"role_profile_name",filters:{name:t}}}).fetch();_.value=((l=A.message)==null?void 0:l.role_profile_name)||"";const B=w({url:"frappe.client.get",params:{doctype:"Activity",name:v.params.activityName,fields:["*"]}});r.value=yield B.fetch();const k=yield w({url:"client_management.client_management.doctype.activity.activity.get_activity_tasks",method:"GET",params:{activity_name:v.params.activityName}}).fetch();if(k.success)u.value=k.tasks;else throw new Error(k.message||"Failed to load tasks")}catch(s){m.value=s.message||"Failed to load activity details"}finally{p.value=!1}});return S(()=>{T()}),(l,s)=>(c(),i("div",M,[f(g(I),{"icon-left":"arrow-left",variant:"ghost",class:"mb-4",onClick:s[0]||(s[0]=t=>g(d).go(-1))},{default:h(()=>s[1]||(s[1]=[b(" Back to Activities ")])),_:1,__:[1]}),p.value?(c(),i("div",O," Loading activity details... ")):x("",!0),m.value?(c(),i("div",P,a(m.value),1)):x("",!0),!p.value&&r.value?(c(),i("div",j,[e("div",q,[e("div",G,[e("div",null,[e("h1",U,a(r.value.activity_name),1),e("div",z,[e("span",null,"Created by: "+a(r.value.owner),1),e("span",null,"Created at: "+a(n(r.value.creation)),1)])]),f(g(R),{theme:r.value.is_recurring?"green":"gray"},{default:h(()=>[b(a(r.value.is_recurring?"Recurring":"One-time"),1)]),_:1},8,["theme"])]),e("div",H,[e("div",null,[s[2]||(s[2]=e("label",{class:"block text-sm font-medium text-gray-500"},"Client",-1)),e("p",J,a(r.value.client),1)]),r.value.is_recurring?(c(),i("div",K,[s[3]||(s[3]=e("label",{class:"block text-sm font-medium text-gray-500"},"Recurring Day",-1)),e("p",Q,a(r.value.recurring_day),1)])):x("",!0)])]),e("div",W,[s[5]||(s[5]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h2",{class:"text-lg font-medium"},"Tasks")],-1)),e("div",X,[e("table",Y,[s[4]||(s[4]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Task Name "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Type "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Assigned To "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," From Date "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," To Date "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Due Days ")])],-1)),e("tbody",Z,[(c(!0),i(V,null,E(o.value,t=>(c(),i("tr",{key:t.name},[e("td",ee,[e("div",te,a(t.task_name),1),t.description?(c(),i("div",se,a(t.description),1)):x("",!0)]),e("td",ae,[f(g(R),{theme:t.task_type==="Internal"?"blue":"green"},{default:h(()=>[b(a(t.task_type),1)]),_:2},1032,["theme"])]),e("td",re,a(t.assigned_to_name||t.assigned_to),1),e("td",oe,[f(g(R),{theme:N(t.status)},{default:h(()=>[b(a(t.status||"Not Started"),1)]),_:2},1032,["theme"])]),e("td",ie,a(t.from_date?n(t.from_date):"-"),1),e("td",ce,a(t.to_date?n(t.to_date):"-"),1),e("td",le,a(t.complete_within_days||"-"),1)]))),128))])])]),o.value.length===0?(c(),i("div",ne," No tasks found ")):x("",!0)])])):x("",!0)]))}};export{_e as default};
//# sourceMappingURL=ActivityDetail-CDQiPhWd.js.map
