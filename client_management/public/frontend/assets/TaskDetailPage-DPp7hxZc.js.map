{"version":3,"file":"TaskDetailPage-DPp7hxZc.js","sources":["../../../../frontend/src/pages/TaskDetailPage.vue"],"sourcesContent":["<template>\r\n  <div class=\"container mx-auto p-6\">\r\n    <div v-if=\"loading\" class=\"text-center py-8\">\r\n      Loading task details...\r\n    </div>\r\n    \r\n    <div v-else class=\"space-y-6\">\r\n      <h1 class=\"text-2xl font-bold\">{{ task.task_name }}</h1>\r\n      \r\n      <div class=\"grid grid-cols-2 gap-4 bg-white p-4 rounded-lg shadow\">\r\n        <div>\r\n          <label class=\"block text-sm font-medium text-gray-700\">Activity</label>\r\n          <p class=\"mt-1 text-sm text-gray-900\">{{ task.activity_name }}</p>\r\n        </div>\r\n        <div>\r\n          <label class=\"block text-sm font-medium text-gray-700\">Status</label>\r\n          <p class=\"mt-1 text-sm text-gray-900\">{{ task.status }}</p>\r\n        </div>\r\n        <div>\r\n          <label class=\"block text-sm font-medium text-gray-700\">From Date</label>\r\n          <p class=\"mt-1 text-sm text-gray-900\">{{ formatDate(task.from_date) }}</p>\r\n        </div>\r\n        <div>\r\n          <label class=\"block text-sm font-medium text-gray-700\">To Date</label>\r\n          <p class=\"mt-1 text-sm text-gray-900\">{{ formatDate(task.to_date) }}</p>\r\n        </div>\r\n        <div>\r\n          <label class=\"block text-sm font-medium text-gray-700\">Priority</label>\r\n          <p class=\"mt-1 text-sm text-gray-900\">{{ task.priority }}</p>\r\n        </div>\r\n      </div>\r\n      \r\n      <div class=\"bg-white p-4 rounded-lg shadow\">\r\n        <label class=\"block text-sm font-medium text-gray-700\">Description</label>\r\n        <p class=\"mt-1 text-sm text-gray-900 whitespace-pre-line\">{{ task.description }}</p>\r\n      </div>\r\n      \r\n      <!-- Comments Section -->\r\n      <div class=\"grid gap-4\" :class=\"isClient ? 'grid-cols-1' : 'grid-cols-2'\">\r\n        <!-- External Comments (visible to all) -->\r\n        <div class=\"bg-white p-4 rounded-lg shadow\">\r\n          <h3 class=\"font-medium text-gray-700 mb-2\">External Comments</h3>\r\n          <div v-if=\"externalComments.length\">\r\n            <div v-for=\"comment in externalComments\" :key=\"comment.name\" class=\"mb-3 p-2 border-b\">\r\n              <p class=\"text-sm\">{{ comment.comment }}</p>\r\n              <p class=\"text-xs text-gray-500 mt-1\">By {{ comment.user_fullname }} on {{ formatDate(comment.creation) }}</p>\r\n            </div>\r\n          </div>\r\n          <p v-else class=\"text-sm text-gray-500\">No external comments</p>\r\n        </div>\r\n        \r\n        <!-- Internal Comments (only for non-clients) -->\r\n        <div v-if=\"!isClient\" class=\"bg-white p-4 rounded-lg shadow\">\r\n          <h3 class=\"font-medium text-gray-700 mb-2\">Internal Comments</h3>\r\n          <div v-if=\"internalComments.length\">\r\n            <div v-for=\"comment in internalComments\" :key=\"comment.name\" class=\"mb-3 p-2 border-b\">\r\n              <p class=\"text-sm\">{{ comment.comment }}</p>\r\n              <p class=\"text-xs text-gray-500 mt-1\">By {{ comment.user_fullname }} on {{ formatDate(comment.creation) }}</p>\r\n            </div>\r\n          </div>\r\n          <p v-else class=\"text-sm text-gray-500\">No internal comments</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport { ref, onMounted, computed } from 'vue';\r\nimport { useRoute } from 'vue-router';\r\nimport { createResource } from 'frappe-ui';\r\n\r\nexport default {\r\n  setup() {\r\n    const route = useRoute();\r\n    const task = ref({});\r\n    const isClient = ref(false);\r\n    const error = ref(null);\r\n    const taskId = ref(route.params.id);\r\n\r\n    // Create resource for fetching task data\r\n    const taskResource = createResource({\r\n      url: 'client_management.client_management.doctype.activity.activity.get_task_with_comments',\r\n      params: {\r\n        task_id: taskId.value\r\n      },\r\n      auto: false,\r\n      onSuccess(data) {\r\n        if (data.error) {\r\n          error.value = data.message || 'Failed to load task details';\r\n          task.value = {};\r\n          isClient.value = false;\r\n        } else {\r\n          task.value = data.task_details;\r\n          isClient.value = data.is_client;\r\n          error.value = null;\r\n        }\r\n      },\r\n      onError(err) {\r\n        error.value = 'Failed to load task details. Please try again.';\r\n        console.error('API Error:', err);\r\n        task.value = {};\r\n        isClient.value = false;\r\n      }\r\n    });\r\n\r\n    // Computed properties for comments\r\n    const externalComments = computed(() => {\r\n      return taskResource.data?.external_comments || [];\r\n    });\r\n\r\n    const internalComments = computed(() => {\r\n      return !isClient.value ? taskResource.data?.internal_comments || [] : [];\r\n    });\r\n\r\n    const loading = computed(() => taskResource.loading);\r\n\r\n    function formatDate(dateString) {\r\n      if (!dateString) return '';\r\n      return new Date(dateString).toLocaleDateString();\r\n    }\r\n\r\n    onMounted(() => {\r\n      if (taskId.value) {\r\n        taskResource.reload();\r\n      } else {\r\n        error.value = 'No task ID provided';\r\n      }\r\n    });\r\n\r\n    function retry() {\r\n      error.value = null;\r\n      taskResource.reload();\r\n    }\r\n\r\n    return {\r\n      task,\r\n      loading,\r\n      error,\r\n      externalComments,\r\n      internalComments,\r\n      isClient,\r\n      formatDate,\r\n      retry,\r\n      taskId\r\n    };\r\n  }\r\n};\r\n</script>"],"names":["_sfc_main","route","useRoute","task","ref","isClient","error","taskId","taskResource","createResource","data","err","externalComments","computed","_a","internalComments","loading","formatDate","dateString","onMounted","retry","_hoisted_1","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_15","_hoisted_16","_hoisted_20","_hoisted_21","_openBlock","_createElementBlock","$setup","_hoisted_2","_hoisted_3","_createElementVNode","_toDisplayString","_cache","_normalizeClass","_hoisted_14","_Fragment","_renderList","comment","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_22"],"mappings":"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"}