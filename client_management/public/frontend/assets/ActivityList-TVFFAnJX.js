var G=Object.defineProperty,O=Object.defineProperties;var Y=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var V=(i,a,o)=>a in i?G(i,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[a]=o,$=(i,a)=>{for(var o in a||(a={}))H.call(a,o)&&V(i,o,a[o]);if(F)for(var o of F(a))I.call(a,o)&&V(i,o,a[o]);return i},j=(i,a)=>O(i,Y(a));var k=(i,a,o)=>new Promise((w,m)=>{var p=l=>{try{u(o.next(l))}catch(_){m(_)}},y=l=>{try{u(o.throw(l))}catch(_){m(_)}},u=l=>l.done?w(l.value):Promise.resolve(l.value).then(p,y);u((o=o.apply(i,a)).next())});import{r as v,q as J,a as r,b as e,d as C,w as A,u as b,i as g,t as c,F as z,k as B,e as K,c as L,o as d,g as D,l as N,a2 as Q}from"./index-CK1KYSDl.js";const U={class:"max-w-7xl mx-auto p-6"},W={class:"flex justify-between items-center mb-6"},X={key:0,class:"text-center py-8"},Z={key:1,class:"mb-4 p-4 bg-red-100 text-red-700 rounded-md"},ee={key:2,class:"bg-white rounded-lg shadow overflow-hidden"},te={class:"overflow-x-auto"},se={class:"min-w-full divide-y divide-gray-200"},ae={class:"bg-gray-50"},oe={class:"bg-white divide-y divide-gray-200"},le={class:"px-6 py-4 whitespace-nowrap"},ie={class:"text-sm font-medium text-gray-900"},ne={class:"px-6 py-4 whitespace-nowrap"},re={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ce={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},de={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ue={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ve={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},pe=["onClick"],_e=["onClick"],ye={key:3,class:"bg-white rounded-lg shadow p-8 text-center"},ge={key:4,class:"mt-4 flex justify-between items-center"},me={class:"text-sm text-gray-600"},xe={class:"flex gap-2"},he={class:"px-4 py-2 text-sm"},fe={key:5,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},be={class:"bg-white rounded-lg shadow-xl w-full max-w-md"},we={class:"p-6"},ke={class:"flex justify-end space-x-3"},Ce=["disabled"],Ae={key:0},De={key:1},Te={__name:"ActivityList",setup(i){const a=K(),o=n=>{a.push({name:"ActivityDetail",params:{activityName:n}})},w=[{label:"Activity Name",key:"activity_name"},{label:"Recurring",key:"recurring"},{label:"Created By",key:"owner"},{label:"Created At",key:"creation"},{label:"Tasks",key:"task_count"},{label:"Client",key:"client"},{label:"Actions",key:"actions"}],m=n=>new Date(n).toLocaleString(),p=v([]),y=v(!0),u=v(""),l=v(1),_=v(1),P=v(0),x=v(!1),h=v(!1),T=v(null),f=()=>k(this,null,function*(){y.value=!0,u.value="";try{const t=yield L({url:"client_management.client_management.doctype.activity.activity.get_user_activities",method:"GET",params:{page:l.value}}).fetch();if(t.success)p.value=t.activities.map(s=>j($({},s),{task_count:s.tasks_count||0})),P.value=t.total_count,_.value=t.total_pages;else throw new Error(t.message||"Failed to load activities")}catch(n){u.value=n.message||"Failed to load activities"}finally{y.value=!1}}),S=()=>{l.value<_.value&&(l.value++,f())},E=()=>{l.value>1&&(l.value--,f())},M=n=>{T.value=n,x.value=!0},R=()=>k(this,null,function*(){h.value=!0;try{yield L({url:"frappe.client.delete",method:"POST",params:{doctype:"Activity",name:T.value.name}}).submit(),x.value=!1,f()}catch(n){u.value=n.message||"Failed to delete activity"}finally{h.value=!1}});return J(()=>{f()}),(n,t)=>(d(),r("div",U,[e("div",W,[t[3]||(t[3]=e("h1",{class:"text-2xl font-semibold"},"My Activities",-1)),C(b(N),{"icon-left":"plus",onClick:t[0]||(t[0]=s=>b(a).push({name:"Template Tasks"}))},{default:A(()=>t[2]||(t[2]=[D(" New Activity ")])),_:1,__:[2]})]),y.value?(d(),r("div",X," Loading activities... ")):g("",!0),u.value?(d(),r("div",Z,c(u.value),1)):g("",!0),!y.value&&p.value.length>0?(d(),r("div",ee,[e("div",te,[e("table",se,[e("thead",ae,[e("tr",null,[(d(),r(z,null,B(w,s=>e("th",{key:s.key,scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},c(s.label),1)),64))])]),e("tbody",oe,[(d(!0),r(z,null,B(p.value,s=>(d(),r("tr",{key:s.name},[e("td",le,[e("div",ie,c(s.activity_name),1)]),e("td",ne,[e("span",{class:Q([s.is_recurring?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800","px-2 inline-flex text-xs leading-5 font-semibold rounded-full"])},c(s.is_recurring?"Yes":"No"),3)]),e("td",re,c(s.owner),1),e("td",ce,c(m(s.creation)),1),e("td",de,c(s.task_count||0),1),e("td",ue,c(s.client_name),1),e("td",ve,[e("button",{onClick:q=>o(s.name),class:"text-indigo-600 hover:text-indigo-900 mr-3"}," View ",8,pe),e("button",{onClick:q=>M(s),class:"text-red-600 hover:text-red-900"}," Delete ",8,_e)])]))),128))])])])])):g("",!0),!y.value&&p.value.length===0?(d(),r("div",ye,t[4]||(t[4]=[e("p",{class:"text-gray-500"},"No activities found",-1)]))):g("",!0),p.value.length>0?(d(),r("div",ge,[e("div",me," Showing "+c(p.value.length)+" of "+c(P.value)+" activities ",1),e("div",xe,[C(b(N),{onClick:E,disabled:l.value===1,variant:"outline",size:"sm"},{default:A(()=>t[5]||(t[5]=[D(" Previous ")])),_:1,__:[5]},8,["disabled"]),e("span",he," Page "+c(l.value)+" of "+c(_.value),1),C(b(N),{onClick:S,disabled:l.value>=_.value,variant:"outline",size:"sm"},{default:A(()=>t[6]||(t[6]=[D(" Next ")])),_:1,__:[6]},8,["disabled"])])])):g("",!0),x.value?(d(),r("div",fe,[e("div",be,[t[8]||(t[8]=e("div",{class:"border-b px-6 py-4"},[e("h3",{class:"text-lg font-medium text-gray-900"},"Confirm Delete")],-1)),e("div",we,[t[7]||(t[7]=e("p",{class:"text-gray-700 mb-6"},"Are you sure you want to delete this activity?",-1)),e("div",ke,[e("button",{onClick:t[1]||(t[1]=s=>x.value=!1),class:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"}," Cancel "),e("button",{onClick:R,class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50",disabled:h.value},[h.value?(d(),r("span",Ae,"Deleting...")):(d(),r("span",De,"Delete"))],8,Ce)])])])])):g("",!0)]))}};export{Te as default};
//# sourceMappingURL=ActivityList-TVFFAnJX.js.map
