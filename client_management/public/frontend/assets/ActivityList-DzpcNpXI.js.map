{"version":3,"file":"ActivityList-DzpcNpXI.js","sources":["../../../../frontend/src/pages/ActivityList.vue"],"sourcesContent":["<template>\r\n  <div class=\"max-w-7xl mx-auto p-6\">\r\n    <div class=\"flex justify-between items-center mb-6\">\r\n      <h1 class=\"text-2xl font-semibold\">My Activities</h1>\r\n      <Button\r\n        icon-left=\"plus\"\r\n        @click=\"router.push({ name: 'Template Tasks' })\"\r\n      >\r\n        New Activity\r\n      </Button>\r\n    </div>\r\n\r\n    <!-- Loading State -->\r\n    <div v-if=\"loading\" class=\"text-center py-8\">\r\n      Loading activities...\r\n    </div>\r\n\r\n    <!-- Error Message -->\r\n    <div v-if=\"errorMessage\" class=\"mb-4 p-4 bg-red-100 text-red-700 rounded-md\">\r\n      {{ errorMessage }}\r\n    </div>\r\n\r\n    <!-- Activities Table -->\r\n    <div v-if=\"!loading && activities.length > 0\" class=\"bg-white rounded-lg shadow overflow-hidden\">\r\n      <div class=\"overflow-x-auto\">\r\n        <table class=\"min-w-full divide-y divide-gray-200\">\r\n          <thead class=\"bg-gray-50\">\r\n            <tr>\r\n              <th v-for=\"column in columns\" :key=\"column.key\" scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                {{ column.label }}\r\n              </th>\r\n            </tr>\r\n          </thead>\r\n          <tbody class=\"bg-white divide-y divide-gray-200\">\r\n            <tr v-for=\"activity in activities\" :key=\"activity.name\">\r\n              <td class=\"px-6 py-4 whitespace-nowrap\">\r\n                <div class=\"text-sm font-medium text-gray-900\">{{ activity.activity_name }}</div>\r\n              </td>\r\n              <td class=\"px-6 py-4 whitespace-nowrap\">\r\n                <span :class=\"activity.is_recurring ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'\" class=\"px-2 inline-flex text-xs leading-5 font-semibold rounded-full\">\r\n                  {{ activity.is_recurring ? 'Yes' : 'No' }}\r\n                </span>\r\n              </td>\r\n              <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n                {{ activity.owner }}\r\n              </td>\r\n              <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n                {{ formatDate(activity.creation) }}\r\n              </td>\r\n              <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n                {{ activity.task_count || 0 }}\r\n              </td>\r\n              <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n                {{ activity.client_name }}\r\n              </td>\r\n              <td class=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\r\n               <button @click=\"viewActivity(activity.name)\" class=\"text-indigo-600 hover:text-indigo-900 mr-3\">\r\n                View\r\n                </button>\r\n               <button @click=\"confirmDelete(activity)\" class=\"text-red-600 hover:text-red-900\">\r\n    Delete\r\n  </button>\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n\r\n    \r\n    <div v-if=\"!loading && activities.length === 0\" class=\"bg-white rounded-lg shadow p-8 text-center\">\r\n      <p class=\"text-gray-500\">No activities found</p>\r\n    </div>\r\n\r\n    <!-- Custom Pagination -->\r\n    <div v-if=\"activities.length > 0\" class=\"mt-4 flex justify-between items-center\">\r\n      <div class=\"text-sm text-gray-600\">\r\n        Showing {{ activities.length }} of {{ totalCount }} activities\r\n      </div>\r\n      <div class=\"flex gap-2\">\r\n        <Button\r\n          @click=\"prevPage\"\r\n          :disabled=\"currentPage === 1\"\r\n          variant=\"outline\"\r\n          size=\"sm\"\r\n        >\r\n          Previous\r\n        </Button>\r\n        <span class=\"px-4 py-2 text-sm\">\r\n          Page {{ currentPage }} of {{ totalPages }}\r\n        </span>\r\n        <Button\r\n          @click=\"nextPage\"\r\n          :disabled=\"currentPage >= totalPages\"\r\n          variant=\"outline\"\r\n          size=\"sm\"\r\n        >\r\n          Next\r\n        </Button>\r\n      </div>\r\n    </div>\r\n\r\n    \r\n   <div v-if=\"showDeleteDialog\" class=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n    <div class=\"bg-white rounded-lg shadow-xl w-full max-w-md\">\r\n      <!-- Dialog Header -->\r\n      <div class=\"border-b px-6 py-4\">\r\n        <h3 class=\"text-lg font-medium text-gray-900\">Confirm Delete</h3>\r\n      </div>\r\n      \r\n      <!-- Dialog Body -->\r\n      <div class=\"p-6\">\r\n        <p class=\"text-gray-700 mb-6\">Are you sure you want to delete this activity?</p>\r\n        \r\n        <!-- Dialog Actions -->\r\n        <div class=\"flex justify-end space-x-3\">\r\n          <button\r\n            @click=\"showDeleteDialog = false\"\r\n            class=\"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50\"\r\n          >\r\n            Cancel\r\n          </button>\r\n          <button\r\n            @click=\"deleteActivity\"\r\n            class=\"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50\"\r\n            :disabled=\"deleting\"\r\n          >\r\n            <span v-if=\"deleting\">Deleting...</span>\r\n            <span v-else>Delete</span>\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport { useRouter } from 'vue-router'\r\nimport { Button, Dialog, createResource } from 'frappe-ui'\r\n\r\nconst router = useRouter()\r\n\r\nconst viewActivity = (activityName) => {\r\n  router.push({\r\n    name: 'ActivityDetail',\r\n    params: { activityName }\r\n  })\r\n}\r\n\r\n\r\nconst columns = [\r\n  { label: 'Activity Name', key: 'activity_name' },\r\n  { label: 'Recurring', key: 'recurring' },\r\n  { label: 'Created By', key: 'owner' },\r\n  { label: 'Created At', key: 'creation' },\r\n  { label: 'Tasks', key: 'task_count' },\r\n  { label: 'Client', key: 'client' },\r\n  { label: 'Actions', key: 'actions' }\r\n]\r\n\r\n\r\nconst formatDate = (dateString) => {\r\n  return new Date(dateString).toLocaleString()\r\n}\r\n\r\n\r\nconst activities = ref([])\r\nconst loading = ref(true)\r\nconst errorMessage = ref('')\r\nconst currentPage = ref(1)\r\nconst totalPages = ref(1)\r\nconst totalCount = ref(0)\r\nconst showDeleteDialog = ref(false)\r\nconst deleting = ref(false)\r\nconst activityToDelete = ref(null)\r\n\r\n\r\nconst fetchActivities = async () => {\r\n  loading.value = true\r\n  errorMessage.value = ''\r\n  \r\n  try {\r\n    const resource = createResource({\r\n      url: 'client_management.client_management.doctype.activity.activity.get_user_activities',\r\n      method: 'GET',\r\n      params: {\r\n        page: currentPage.value\r\n      }\r\n    })\r\n    \r\n    const response = await resource.fetch()\r\n    \r\n    if (response.success) {\r\n      activities.value = response.activities.map(activity => ({\r\n        ...activity,\r\n        task_count: activity.tasks_count || 0\r\n      }))\r\n      totalCount.value = response.total_count\r\n      totalPages.value = response.total_pages\r\n    } else {\r\n      throw new Error(response.message || 'Failed to load activities')\r\n    }\r\n  } catch (error) {\r\n    errorMessage.value = error.message || 'Failed to load activities'\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// Pagination methods\r\nconst nextPage = () => {\r\n  if (currentPage.value < totalPages.value) {\r\n    currentPage.value++\r\n    fetchActivities()\r\n  }\r\n}\r\n\r\nconst prevPage = () => {\r\n  if (currentPage.value > 1) {\r\n    currentPage.value--\r\n    fetchActivities()\r\n  }\r\n}\r\n\r\n\r\nconst editActivity = (activityName) => {\r\n  router.push({\r\n    name: 'ActivityForm',\r\n    params: { activityName }\r\n  })\r\n}\r\n\r\nconst confirmDelete = (activity) => {\r\n  activityToDelete.value = activity;\r\n  showDeleteDialog.value = true;\r\n};\r\n\r\nconst deleteActivity = async () => {\r\n  deleting.value = true;\r\n  try {\r\n    const resource = createResource({\r\n      url: 'frappe.client.delete',\r\n      method: 'POST',\r\n      params: {\r\n        doctype: 'Activity',\r\n        name: activityToDelete.value.name\r\n      }\r\n    });\r\n    \r\n    await resource.submit();\r\n    showDeleteDialog.value = false;\r\n    fetchActivities();\r\n  } catch (error) {\r\n    errorMessage.value = error.message || 'Failed to delete activity';\r\n  } finally {\r\n    deleting.value = false;\r\n  }\r\n};\r\n\r\n\r\nonMounted(() => {\r\n  fetchActivities()\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"],"names":["router","useRouter","viewActivity","activityName","columns","formatDate","dateString","activities","ref","loading","errorMessage","currentPage","totalPages","totalCount","showDeleteDialog","deleting","activityToDelete","fetchActivities","__async","response","createResource","activity","__spreadProps","__spreadValues","error","nextPage","prevPage","confirmDelete","deleteActivity","onMounted","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_cache","_createVNode","_unref","Button","$event","_hoisted_3","_hoisted_4","_toDisplayString","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_Fragment","_renderList","column","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_normalizeClass","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28"],"mappings":"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"}