{"version":3,"file":"ActivityDetail-Dz1zsr_a.js","sources":["../../../../frontend/src/pages/ActivityDetail.vue"],"sourcesContent":["<template>\r\n  <div class=\"max-w-4xl mx-auto p-6\">\r\n  \r\n    <Button\r\n      icon-left=\"arrow-left\"\r\n      variant=\"ghost\"\r\n      class=\"mb-4\"\r\n      @click=\"router.go(-1)\"\r\n    >\r\n      Back to Activities\r\n    </Button>\r\n\r\n    \r\n    <div v-if=\"loading\" class=\"text-center py-8\">\r\n      Loading activity details...\r\n    </div>\r\n\r\n    \r\n    <div v-if=\"errorMessage\" class=\"mb-4 p-4 bg-red-100 text-red-700 rounded-md\">\r\n      {{ errorMessage }}\r\n    </div>\r\n\r\n    <!-- Activity Details -->\r\n    <div v-if=\"!loading && activity\" class=\"space-y-6\">\r\n      \r\n      <div class=\"bg-white rounded-lg shadow p-6\">\r\n        <div class=\"flex justify-between items-start\">\r\n          <div>\r\n            <h1 class=\"text-2xl font-semibold\">{{ activity.activity_name }}</h1>\r\n            <div class=\"flex items-center mt-2 space-x-4 text-sm text-gray-600\">\r\n              <span>Created by: {{ activity.owner }}</span>\r\n              <span>Created at: {{ formatDate(activity.creation) }}</span>\r\n            </div>\r\n          </div>\r\n          <Badge :theme=\"activity.is_recurring ? 'green' : 'gray'\">\r\n            {{ activity.is_recurring ? 'Recurring' : 'One-time' }}\r\n          </Badge>\r\n        </div>\r\n\r\n        <div class=\"mt-4 grid grid-cols-2 gap-4\">\r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-500\">Client</label>\r\n            <p class=\"mt-1 text-sm text-gray-900\">{{ activity.client }}</p>\r\n          </div>\r\n          <div v-if=\"activity.is_recurring\">\r\n            <label class=\"block text-sm font-medium text-gray-500\">Recurring Day</label>\r\n            <p class=\"mt-1 text-sm text-gray-900\">{{ activity.recurring_day }}</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      \r\n      <div class=\"bg-white rounded-lg shadow overflow-hidden\">\r\n        <div class=\"px-6 py-4 border-b border-gray-200\">\r\n          <h2 class=\"text-lg font-medium\">Tasks</h2>\r\n        </div>\r\n\r\n        \r\n        <div class=\"overflow-x-auto\">\r\n          <table class=\"min-w-full divide-y divide-gray-200\">\r\n            <thead class=\"bg-gray-50\">\r\n              <tr>\r\n                <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  Task Name\r\n                </th>\r\n                <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  Type\r\n                </th>\r\n                <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  Assigned To\r\n                </th>\r\n                <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  Status\r\n                </th>\r\n                <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  From Date\r\n                </th>\r\n                <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  To Date\r\n                </th>\r\n                <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  Due Days\r\n                </th>\r\n              </tr>\r\n            </thead>\r\n            <tbody class=\"bg-white divide-y divide-gray-200\">\r\n              <tr v-for=\"task in filteredTasks\" :key=\"task.name\">\r\n                <td class=\"px-6 py-4 whitespace-nowrap\">\r\n                  <div class=\"text-sm font-medium text-gray-900\">{{ task.task_name }}</div>\r\n                  <div v-if=\"task.description\" class=\"text-sm text-gray-500 mt-1\">\r\n                    {{ task.description }}\r\n                  </div>\r\n                </td>\r\n                <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n                  <Badge :theme=\"task.task_type === 'Internal' ? 'blue' : 'green'\">\r\n                    {{ task.task_type }}\r\n                  </Badge>\r\n                </td>\r\n                <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n                  {{ task.assigned_to_name || task.assigned_to }}\r\n                </td>\r\n                <td class=\"px-6 py-4 whitespace-nowrap\">\r\n                  <Badge :theme=\"getStatusBadgeTheme(task.status)\">\r\n                    {{ task.status || 'Not Started' }}\r\n                  </Badge>\r\n                </td>\r\n                <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n                  {{ task.from_date ? formatDate(task.from_date) : '-' }}\r\n                </td>\r\n                <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n                  {{ task.to_date ? formatDate(task.to_date) : '-' }}\r\n                </td>\r\n                <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n                  {{ task.complete_within_days || '-' }}\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n\r\n        \r\n        <div v-if=\"filteredTasks.length === 0\" class=\"p-8 text-center text-gray-500\">\r\n          No tasks found\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, computed } from 'vue'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nimport { Button, Badge, createResource } from 'frappe-ui'\r\n\r\nconst route = useRoute()\r\nconst router = useRouter()\r\n\r\n\r\nconst activity = ref(null)\r\nconst tasks = ref([])\r\nconst loading = ref(true)\r\nconst errorMessage = ref('')\r\nconst userRoleProfile = ref('')\r\n\r\n\r\nconst filteredTasks = computed(() => {\r\n  const isClient = userRoleProfile.value === 'Client'\r\n  return isClient \r\n    ? tasks.value.filter(task => !task.hide_to_client)\r\n    : tasks.value\r\n})\r\n\r\n\r\nconst formatDate = (dateString) => {\r\n  return new Date(dateString).toLocaleDateString()\r\n}\r\n\r\n\r\nconst getStatusBadgeTheme = (status) => {\r\n  switch (status) {\r\n    case 'Completed': return 'green'\r\n    case 'In Progress': return 'blue'\r\n    case 'Overdue': return 'red'\r\n    default: return 'gray'\r\n  }\r\n}\r\n\r\n\r\nconst getCurrentUser = async () => {\r\n  const resource = createResource({\r\n    url: 'frappe.client.get',\r\n    params: {\r\n      doctype: 'User',\r\n      name: 'Administrator', \r\n      fields: ['role_profile_name']\r\n    }\r\n  })\r\n  return await resource.fetch()\r\n}\r\n\r\nconst fetchActivityDetails = async () => {\r\n  loading.value = true\r\n  errorMessage.value = ''\r\n  \r\n  try {\r\n    // First get current user\r\n    const userResource = createResource({\r\n      url: 'frappe.auth.get_logged_user'\r\n    })\r\n    const username = await userResource.fetch()\r\n    \r\n    // Then get user role profile\r\n    const profileResource = createResource({\r\n      url: 'frappe.client.get_value',\r\n      params: {\r\n        doctype: 'User',\r\n        fieldname: 'role_profile_name',\r\n        filters: { name: username }\r\n      }\r\n    })\r\n    const profileData = await profileResource.fetch()\r\n    userRoleProfile.value = profileData.message?.role_profile_name || ''\r\n\r\n    \r\n    const activityResource = createResource({\r\n      url: 'frappe.client.get',\r\n      params: {\r\n        doctype: 'Activity',\r\n        name: route.params.activityName,\r\n        fields: ['*']\r\n      }\r\n    })\r\n    activity.value = await activityResource.fetch()\r\n\r\n    \r\n    const tasksResource = createResource({\r\n      url: 'client_management.client_management.doctype.activity.activity.get_activity_tasks',\r\n      method: 'GET',\r\n      params: {\r\n        activity_name: route.params.activityName\r\n      }\r\n    })\r\n    const tasksResponse = await tasksResource.fetch()\r\n    \r\n    if (tasksResponse.success) {\r\n      tasks.value = tasksResponse.tasks\r\n    } else {\r\n      throw new Error(tasksResponse.message || 'Failed to load tasks')\r\n    }\r\n  } catch (error) {\r\n    errorMessage.value = error.message || 'Failed to load activity details'\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n\r\nonMounted(() => {\r\n  fetchActivityDetails()\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"],"names":["route","useRoute","router","useRouter","activity","ref","tasks","loading","errorMessage","userRoleProfile","filteredTasks","computed","task","formatDate","dateString","getStatusBadgeTheme","status","fetchActivityDetails","__async","username","createResource","profileData","_a","activityResource","tasksResponse","error","onMounted","_openBlock","_createElementBlock","_hoisted_1","_createVNode","_unref","Button","_cache","$event","_hoisted_2","_hoisted_3","_toDisplayString","_hoisted_4","_createElementVNode","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","Badge","_createTextVNode","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_Fragment","_renderList","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26"],"mappings":"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"}