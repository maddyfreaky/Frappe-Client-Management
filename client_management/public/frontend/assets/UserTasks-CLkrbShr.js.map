{"version":3,"file":"UserTasks-CLkrbShr.js","sources":["../../../../frontend/src/pages/UserTasks.vue"],"sourcesContent":["<template>\r\n  <div class=\"max-w-7xl mx-auto p-6\">\r\n    <div class=\"flex justify-between items-center mb-6\">\r\n      <h1 class=\"text-2xl font-semibold\">My Tasks</h1>\r\n    </div>\r\n\r\n    <!-- Loading State -->\r\n    <div v-if=\"loading\" class=\"text-center py-8\">\r\n      Loading tasks...\r\n    </div>\r\n\r\n    \r\n    <!-- Tasks Table -->\r\n    <div v-if=\"!loading\" class=\"bg-white rounded-lg shadow overflow-hidden\">\r\n\r\n      <div class=\"overflow-x-auto\">\r\n         <!-- Search Field -->\r\n    <div class=\"mt-4\">\r\n      <div class=\"relative rounded-md shadow-sm max-w-md\">\r\n        <div class=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n          <svg class=\"h-5 w-5 text-gray-400\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n            <path fill-rule=\"evenodd\" d=\"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z\" clip-rule=\"evenodd\" />\r\n          </svg>\r\n        </div>\r\n        <input\r\n          v-model=\"searchQuery\"\r\n          type=\"text\"\r\n          class=\"focus:ring-indigo-500 focus:border-indigo-500 block w-full pl-10 sm:text-sm border-gray-300 rounded-md py-2\"\r\n          placeholder=\"Search ...\"\r\n          @input=\"filterTasks\"\r\n        />\r\n      </div>\r\n    </div>\r\n\r\n        <table class=\"min-w-full divide-y divide-gray-200 mt-5\">\r\n          <thead class=\"bg-gray-50\">\r\n            <tr>\r\n              <th v-for=\"column in columns\" :key=\"column.key\" scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                {{ column.label }}\r\n              </th>\r\n              <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n            Comments\r\n        </th> \r\n            </tr>\r\n          </thead>\r\n       \r\n          <tbody class=\"bg-white divide-y divide-gray-200\">\r\n            <tr v-for=\"task in paginatedTasks\" :key=\"task.name\" :class=\"{'opacity-50': isTaskDisabled(task)}\">\r\n             \r\n              <td class=\"px-6 py-4 whitespace-nowrap\">\r\n                {{ task.activity_name }}\r\n              </td>\r\n\r\n              <td class=\"px-6 py-4 whitespace-nowrap\">\r\n              <router-link :to=\"`/tasks/${task.name}`\" class=\"text-indigo-600 hover:text-indigo-900\">\r\n                {{ task.task_name }}\r\n              </router-link>\r\n            </td>\r\n              <td class=\"px-6 py-4 whitespace-nowrap\">\r\n                {{ formatDate(task.from_date) }}\r\n              </td>\r\n              <td class=\"px-6 py-4 whitespace-nowrap\">\r\n                {{ formatDate(task.to_date) }}\r\n              </td>\r\n              <td class=\"px-6 py-4 whitespace-nowrap\">\r\n                <span :class=\"priorityClass(task.priority)\" class=\"px-2 inline-flex text-xs leading-5 font-semibold rounded-full\">\r\n                  {{ task.priority }}\r\n                </span>\r\n              </td>\r\n             \r\n              <td class=\"px-6 py-4 whitespace-nowrap\">\r\n  <div class=\"relative\">\r\n    <select \r\n      v-model=\"task.status\" \r\n      @focus=\"previousStatus = task.status\"\r\n      @change=\"handleStatusChange(task)\"\r\n      :disabled=\"isTaskDisabled(task) || task.updating\"\r\n      class=\"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md\"\r\n    >\r\n      <option v-for=\"option in statusOptions\" :key=\"option\" :value=\"option\">\r\n        {{ option }}\r\n      </option>\r\n    </select>\r\n    <svg \r\n      v-if=\"task.updating\"\r\n      class=\"animate-spin h-5 w-5 text-indigo-600 absolute right-2 top-2\" \r\n      xmlns=\"http://www.w3.org/2000/svg\" \r\n      fill=\"none\" \r\n      viewBox=\"0 0 24 24\"\r\n    >\r\n      <circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle>\r\n      <path class=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n    </svg>\r\n  </div>\r\n</td>\r\n            \r\n            \r\n              <td class=\"px-6 py-4 whitespace-nowrap\">\r\n                <div class=\"flex space-x-2\">\r\n                  <button \r\n                    v-if=\"!isClient\"\r\n                    @click=\"openCommentModal(task, 'Internal')\"\r\n                    class=\"p-1 rounded-md bg-blue-100 text-blue-800 hover:bg-blue-200\"\r\n                    title=\"Internal Comments\"\r\n                  >\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                      <path fill-rule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-6-3a2 2 0 11-4 0 2 2 0 014 0zm-2 4a5 5 0 00-4.546 2.916A5.986 5.986 0 0010 16a5.986 5.986 0 004.546-2.084A5 5 0 0010 11z\" clip-rule=\"evenodd\" />\r\n                    </svg>\r\n                  </button>\r\n                  <button \r\n                    @click=\"openCommentModal(task, 'External')\"\r\n                    class=\"p-1 rounded-md bg-green-100 text-green-800 hover:bg-green-200\"\r\n                    title=\"External Comments\"\r\n                  >\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"CurrentColor\">\r\n                      <path fill-rule=\"evenodd\" d=\"M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z\" clip-rule=\"evenodd\" />\r\n                    </svg>\r\n                  </button>\r\n                </div>\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n        \r\n        <!-- Pagination Controls -->\r\n        <div class=\"flex items-center justify-between px-6 py-3 bg-white border-t border-gray-200\">\r\n          <div class=\"flex-1 flex justify-between sm:hidden\">\r\n            <button \r\n              @click=\"currentPage = currentPage - 1\" \r\n              :disabled=\"currentPage === 1\"\r\n              class=\"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50\"\r\n            >\r\n              Previous\r\n            </button>\r\n            <button \r\n              @click=\"currentPage = currentPage + 1\" \r\n              :disabled=\"currentPage === totalPages\"\r\n              class=\"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50\"\r\n            >\r\n              Next\r\n            </button>\r\n          </div>\r\n          <div class=\"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between\">\r\n            <div>\r\n              <p class=\"text-sm text-gray-700\">\r\n                Showing\r\n                <span class=\"font-medium\">{{ (currentPage - 1) * pageSize + 1 }}</span>\r\n                to\r\n                <span class=\"font-medium\">{{ Math.min(currentPage * pageSize, filteredTasks.length) }}</span>\r\n                of\r\n                <span class=\"font-medium\">{{ filteredTasks.length }}</span>\r\n                results\r\n              </p>\r\n            </div>\r\n            <div>\r\n              <nav class=\"relative z-0 inline-flex rounded-md shadow-sm -space-x-px\" aria-label=\"Pagination\">\r\n                <button \r\n                  @click=\"currentPage = currentPage - 1\" \r\n                  :disabled=\"currentPage === 1\"\r\n                  :class=\"{'opacity-50 cursor-not-allowed': currentPage === 1, 'hover:bg-gray-50': currentPage > 1}\"\r\n                  class=\"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500\"\r\n                >\r\n                  <span class=\"sr-only\">Previous</span>\r\n                  <svg class=\"h-5 w-5\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\">\r\n                    <path fill-rule=\"evenodd\" d=\"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z\" clip-rule=\"evenodd\" />\r\n                  </svg>\r\n                </button>\r\n                \r\n                <!-- Page numbers -->\r\n                <button \r\n                  v-for=\"page in visiblePages\" \r\n                  :key=\"page\"\r\n                  @click=\"currentPage = page\"\r\n                  :class=\"{'z-10 bg-indigo-50 border-indigo-500 text-indigo-600': currentPage === page, 'bg-white border-gray-300 text-gray-500 hover:bg-gray-50': currentPage !== page}\"\r\n                  class=\"relative inline-flex items-center px-4 py-2 border text-sm font-medium\"\r\n                >\r\n                  {{ page }}\r\n                </button>\r\n                \r\n                <button \r\n                  @click=\"currentPage = currentPage + 1\" \r\n                  :disabled=\"currentPage === totalPages\"\r\n                  :class=\"{'opacity-50 cursor-not-allowed': currentPage === totalPages, 'hover:bg-gray-50': currentPage < totalPages}\"\r\n                  class=\"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500\"\r\n                >\r\n                  <span class=\"sr-only\">Next</span>\r\n                  <svg class=\"h-5 w-5\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\">\r\n                    <path fill-rule=\"evenodd\" d=\"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z\" clip-rule=\"evenodd\" />\r\n                  </svg>\r\n                </button>\r\n              </nav>\r\n            </div>\r\n            \r\n            <!-- Page size selector -->\r\n            <div class=\"flex items-center\">\r\n              <span class=\"text-sm text-gray-700 mr-2 text-nowrap\">Rows per page:</span>\r\n              <select \r\n                v-model=\"pageSize\" \r\n                @change=\"currentPage = 1\"\r\n                class=\"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md\"\r\n              >\r\n                <option v-for=\"option in pageSizeOptions\" :key=\"option\" :value=\"option\">\r\n                  {{ option }}\r\n                </option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n          \r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Comment Modal -->\r\n  <div v-if=\"showCommentModal\" class=\"fixed inset-0 z-50 overflow-y-auto\">\r\n    <div class=\"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0\">\r\n      <!-- Background overlay -->\r\n      <div class=\"fixed inset-0 transition-opacity\" aria-hidden=\"true\">\r\n        <div class=\"absolute inset-0 bg-gray-500 opacity-75\" @click=\"closeCommentModal\"></div>\r\n      </div>\r\n\r\n      <!-- Modal container -->\r\n      <div class=\"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full\">\r\n        <div class=\"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4\">\r\n          <div class=\"sm:flex sm:items-start\">\r\n            <div class=\"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full\">\r\n              <h3 class=\"text-lg leading-6 font-medium text-gray-900\">\r\n                {{ selectedCommentType }} Comments - Activity: {{ currentActivity.activity_name }}\r\n              </h3>\r\n              <div class=\"mt-4\">\r\n                <!-- Comments List -->\r\n                <div class=\"border rounded-lg p-4 max-h-96 overflow-y-auto mb-4\">\r\n                  <div v-for=\"comment in comments\" :key=\"comment.name\" class=\"mb-4 last:mb-0\">\r\n                    <div class=\"flex justify-between items-start\">\r\n                      <div class=\"font-medium\">{{ comment.user_fullname || comment.comment_by.split('@')[0] }}</div>\r\n                      <div class=\"text-sm text-gray-500\">{{ formatDateTime(comment.comment_date) }}</div>\r\n                    </div>\r\n                    <div class=\"mt-1 text-sm text-gray-800\">{{ comment.comment }}</div>\r\n                    <div v-if=\"comment.attachment\" class=\"mt-2\">\r\n                      <a :href=\"comment.attachment\" target=\"_blank\" class=\"text-blue-600 hover:text-blue-800 text-sm\">\r\n                        View Attachment\r\n                      </a>\r\n                    </div>\r\n                    <div v-if=\"comment.is_temp\" class=\"mt-1 text-xs text-gray-500\">\r\n                      Posting...\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <!-- New Comment Form -->\r\n                <div class=\"border-t pt-4\">\r\n                  <textarea\r\n                    v-model=\"newComment\"\r\n                    class=\"w-full border rounded-md p-2\"\r\n                    rows=\"3\"\r\n                    placeholder=\"Type your comment here...\"\r\n                  ></textarea>\r\n                  <div class=\"flex justify-between items-center mt-2\">\r\n                    <div class=\"flex items-center space-x-2\">\r\n                      <input\r\n                        type=\"file\"\r\n                        ref=\"fileInput\"\r\n                        @change=\"handleFileUpload\"\r\n                        class=\"hidden\"\r\n                      />\r\n                      <button\r\n                        @click=\"$refs.fileInput.click()\"\r\n                        class=\"text-sm text-gray-600 hover:text-gray-800\"\r\n                      >\r\n                        Attach File\r\n                      </button>\r\n                      <span v-if=\"attachment\" class=\"text-sm text-gray-600 flex items-center\">\r\n                        {{ attachment.name }}\r\n                        <button @click=\"removeAttachment\" class=\"ml-1 text-red-500 hover:text-red-700\">\r\n                          <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-4 w-4\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                            <path fill-rule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clip-rule=\"evenodd\" />\r\n                          </svg>\r\n                        </button>\r\n                      </span>\r\n                    </div>\r\n                    <button\r\n                      @click=\"submitComment\"\r\n                      class=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700\"\r\n                      :disabled=\"!newComment\"\r\n                    >\r\n                      Post Comment\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse\">\r\n          <button\r\n            type=\"button\"\r\n            class=\"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm\"\r\n            @click=\"closeCommentModal\"\r\n          >\r\n            Close\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n    <!-- Task Details Modal -->\r\n    <Dialog\r\n      v-model=\"showTaskModal\"\r\n      :title=\"selectedTask.task_name || 'Task Details'\"\r\n      size=\"xl\"\r\n      :dismissable=\"true\"\r\n    >\r\n      <div v-if=\"selectedTask.name\" class=\"space-y-4\">\r\n        <div class=\"grid grid-cols-2 gap-4\">\r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-700\">Activity</label>\r\n            <p class=\"mt-1 text-sm text-gray-900\">{{ selectedTask.activity_name }}</p>\r\n          </div>\r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-700\">Status</label>\r\n            <p class=\"mt-1 text-sm text-gray-900\">{{ selectedTask.status }}</p>\r\n          </div>\r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-700\">From Date</label>\r\n            <p class=\"mt-1 text-sm text-gray-900\">{{ formatDate(selectedTask.from_date) }}</p>\r\n          </div>\r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-700\">To Date</label>\r\n            <p class=\"mt-1 text-sm text-gray-900\">{{ formatDate(selectedTask.to_date) }}</p>\r\n          </div>\r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-700\">Priority</label>\r\n            <p class=\"mt-1 text-sm text-gray-900\">{{ selectedTask.priority }}</p>\r\n          </div>\r\n        </div>\r\n        <div>\r\n          <label class=\"block text-sm font-medium text-gray-700\">Description</label>\r\n          <p class=\"mt-1 text-sm text-gray-900 whitespace-pre-line\">{{ selectedTask.description }}</p>\r\n        </div>\r\n      </div>\r\n      <div v-else class=\"text-center py-8\">\r\n        Loading task details...\r\n      </div>\r\n      <template #actions>\r\n        <Button\r\n          variant=\"solid\"\r\n          @click=\"showTaskModal = false\"\r\n        >\r\n          Close\r\n        </Button>\r\n      </template>\r\n    </Dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed, onMounted, watch } from 'vue'\r\nimport { Button, Dialog, createResource } from 'frappe-ui'\r\n\r\nconst columns = [\r\n    { label: 'Activity', key: 'activity_name' },\r\n  { label: 'Task Name', key: 'task_name' },\r\n  { label: 'From Date', key: 'from_date' },\r\n  { label: 'To Date', key: 'to_date' },\r\n  { label: 'Priority', key: 'priority' },\r\n  { label: 'Status', key: 'status' }\r\n]\r\n\r\nconst statusOptions = ['Not Started', 'Working', 'Completed']\r\n\r\nconst tasks = ref([])\r\nconst filteredTasks = ref([])\r\nconst loading = ref(true)\r\nconst errorMessage = ref('')\r\nconst showTaskModal = ref(false)\r\nconst selectedTask = ref({\r\n  task_name: '',\r\n  activity_name: '',\r\n  status: '',\r\n  from_date: '',\r\n  to_date: '',\r\n  priority: '',\r\n  description: ''\r\n})\r\nconst previousStatus = ref(null)\r\n\r\nconst showCommentModal = ref(false)\r\nconst selectedCommentType = ref('')\r\nconst comments = ref([])\r\nconst newComment = ref('')\r\nconst attachment = ref(null)\r\nconst fileInput = ref(null)\r\nconst currentActivity = ref({})\r\n\r\n// Search query - Moved to the top to avoid reference errors\r\nconst searchQuery = ref('')\r\n\r\n// Pagination variables\r\nconst currentPage = ref(1)\r\nconst pageSize = ref(10)\r\nconst pageSizeOptions = [5, 10, 20, 50]\r\n\r\n// Pagination computed properties\r\nconst totalPages = computed(() => {\r\n  return Math.ceil(filteredTasks.value.length / pageSize.value)\r\n})\r\n\r\nconst paginatedTasks = computed(() => {\r\n  const startIndex = (currentPage.value - 1) * pageSize.value\r\n  return filteredTasks.value.slice(startIndex, startIndex + pageSize.value)\r\n})\r\n\r\nconst visiblePages = computed(() => {\r\n  const maxVisiblePages = 5\r\n  const halfVisible = Math.floor(maxVisiblePages / 2)\r\n  \r\n  let startPage = Math.max(1, currentPage.value - halfVisible)\r\n  let endPage = Math.min(totalPages.value, startPage + maxVisiblePages - 1)\r\n  \r\n  if (endPage - startPage + 1 < maxVisiblePages) {\r\n    startPage = Math.max(1, endPage - maxVisiblePages + 1)\r\n  }\r\n  \r\n  const pages = []\r\n  for (let i = startPage; i <= endPage; i++) {\r\n    pages.push(i)\r\n  }\r\n  \r\n  return pages\r\n})\r\n\r\n// Watch for changes to reset to first page\r\nwatch(searchQuery, () => {\r\n  currentPage.value = 1\r\n})\r\n\r\nwatch(filteredTasks, () => {\r\n  currentPage.value = 1\r\n})\r\n\r\nconst openCommentModal = async (task, commentType) => {\r\n  resetCommentForm();\r\n  selectedCommentType.value = commentType;\r\n  currentActivity.value = {\r\n    name: task.activity_docname,\r\n    activity_name: task.activity_name\r\n  };\r\n  showCommentModal.value = true;\r\n  // Use explicit parameters when fetching comments\r\n  await fetchComments(task.activity_docname, commentType);\r\n};\r\n\r\nconst closeCommentModal = () => {\r\n  resetCommentForm()\r\n  showCommentModal.value = false\r\n}\r\n\r\nconst resetCommentForm = () => {\r\n  newComment.value = ''\r\n  attachment.value = null\r\n  if (fileInput.value) fileInput.value.value = ''\r\n}\r\n\r\nconst removeAttachment = () => {\r\n  attachment.value = null\r\n  if (fileInput.value) fileInput.value.value = ''\r\n}\r\n\r\nconst isClient = ref(false);\r\n\r\n// Fetch client status when component mounts\r\nonMounted(async () => {\r\n  try {\r\n    const response = await fetch('/api/method/client_management.client_management.doctype.activity_comment.activity_comment.is_user_client');\r\n    const result = await response.json();\r\n    isClient.value = result.message || false;\r\n  } catch (error) {\r\n    console.error(\"Error checking user role:\", error);\r\n    isClient.value = false;\r\n  }\r\n});\r\n\r\nconst formatDateTime = (dateString) => {\r\n  if (!dateString) return ''\r\n  const date = new Date(dateString)\r\n  return date.toLocaleString() \r\n}\r\n\r\nconst fetchComments = async (activityName = null, commentType = null) => {\r\n  try {\r\n    // Use provided parameters or fall back to the component state\r\n    const activityNameToUse = activityName || currentActivity.value.name;\r\n    const commentTypeToUse = commentType || selectedCommentType.value;\r\n    \r\n    // Check if we have the required parameters\r\n    if (!activityNameToUse || !commentTypeToUse) {\r\n      console.error(\"Missing parameters for fetching comments\");\r\n      return;\r\n    }\r\n\r\n    const resource = createResource({\r\n      url: 'client_management.client_management.doctype.activity_comment.activity_comment.get_activity_comments',\r\n      method: 'GET',\r\n      params: {\r\n        activity_name: activityNameToUse,\r\n        comment_type: commentTypeToUse\r\n      }\r\n    });\r\n\r\n    const response = await resource.fetch();\r\n\r\n    if (response.success) {\r\n      comments.value = response.comments.map(comment => ({\r\n        ...comment,\r\n        user_fullname: comment.comment_by_fullname || comment.comment_by.split('@')[0],\r\n      }));\r\n    }\r\n  } catch (error) {\r\n    console.error(\"Error fetching comments:\", error);\r\n  }\r\n};\r\n\r\nconst handleFileUpload = (e) => {\r\n  const file = e.target.files[0]\r\n  if (file) {\r\n    attachment.value = file\r\n  }\r\n}\r\n\r\nconst submitComment = async () => {\r\n  try {\r\n    if (!newComment.value.trim()) {\r\n      errorMessage.value = \"Please enter a comment\";\r\n      return;\r\n    }\r\n\r\n    // Store the comment text before resetting the form\r\n    const commentText = newComment.value.trim();\r\n\r\n    const formData = new FormData();\r\n    formData.append('activity_name', currentActivity.value.name);\r\n    formData.append('comment_type', selectedCommentType.value);\r\n    formData.append('comment', commentText);\r\n\r\n    if (attachment.value) {\r\n      formData.append('file', attachment.value);\r\n    }\r\n\r\n    // Add CSRF token if available\r\n    if (window.frappe?.csrf_token) {\r\n      formData.append('csrf_token', window.frappe.csrf_token);\r\n    }\r\n\r\n    // Show loading state\r\n    const loadingComment = {\r\n      name: 'loading-' + Date.now(),\r\n      comment: commentText,\r\n      comment_by: window.frappe?.session?.user || 'Unknown User',\r\n      comment_by_fullname: 'Posting...',\r\n      user_fullname: 'Posting...',\r\n      comment_date: new Date().toISOString(),\r\n      is_loading: true,\r\n      attachment: null,\r\n    };\r\n    \r\n    comments.value.unshift(loadingComment);\r\n    resetCommentForm();\r\n\r\n    const response = await fetch(\r\n      '/api/method/client_management.client_management.doctype.activity_comment.activity_comment.add_activity_comment',\r\n      {\r\n        method: 'POST',\r\n        body: formData,\r\n      }\r\n    );\r\n\r\n    const result = await response.json();\r\n    console.log('API Response:', result);\r\n\r\n    if (result.message && result.message.success) {\r\n      // Remove loading comment\r\n      comments.value = comments.value.filter(c => !c.is_loading);\r\n      \r\n      // Add the new comment directly to the list instead of refreshing\r\n      const newCommentData = {\r\n        name: result.message.comment_id,\r\n        comment: commentText, // Use the stored comment text\r\n        comment_by: window.frappe?.session?.user || 'Unknown User',\r\n        comment_by_fullname: result.message.user_fullname,\r\n        user_fullname: result.message.user_fullname,\r\n        comment_date: result.message.comment_date,\r\n        attachment: result.message.attachment_url\r\n      };\r\n      \r\n      comments.value.unshift(newCommentData);\r\n      \r\n      // Show success message using Frappe notification (no alert)\r\n      if (typeof frappe !== 'undefined' && frappe.show_alert) {\r\n        frappe.show_alert({\r\n          message: result.message.message || 'Comment added successfully',\r\n          indicator: 'green'\r\n        }, 3);\r\n      }\r\n      // Removed the alert() fallback\r\n    } else {\r\n      // Remove loading comment on error\r\n      comments.value = comments.value.filter(c => !c.is_loading);\r\n      \r\n      let errorMsg = \"Failed to submit comment\";\r\n      \r\n      if (result.message && result.message.message) {\r\n        errorMsg = result.message.message;\r\n      } else if (result.message) {\r\n        errorMsg = typeof result.message === 'string' ? result.message : \"Server error occurred\";\r\n      }\r\n      \r\n      errorMessage.value = errorMsg;\r\n      \r\n      // Show error message using Frappe notification (no alert)\r\n      if (typeof frappe !== 'undefined' && frappe.show_alert) {\r\n        frappe.show_alert({\r\n          message: errorMsg,\r\n          indicator: 'red'\r\n        }, 5);\r\n      }\r\n      // Removed the alert() fallback\r\n    }\r\n  } catch (error) {\r\n    console.error(\"Comment submission failed:\", error);\r\n    // Remove loading comment on error\r\n    comments.value = comments.value.filter(c => !c.is_loading);\r\n    \r\n    const errorMsg = error.message || \"Failed to submit comment. Please try again.\";\r\n    errorMessage.value = errorMsg;\r\n    \r\n    // Show error message using Frappe notification (no alert)\r\n    if (typeof frappe !== 'undefined' && frappe.show_alert) {\r\n      frappe.show_alert({\r\n        message: errorMsg,\r\n        indicator: 'red'\r\n      }, 5);\r\n    }\r\n    // Removed the alert() fallback\r\n  }\r\n};\r\n\r\nconst createFileFormData = () => {\r\n  const formData = new FormData()\r\n  formData.append('file', attachment.value)\r\n  formData.append('doctype', 'Activity Comment')\r\n  formData.append('fieldname', 'attachment')\r\n  formData.append('is_private', 1)\r\n  return formData\r\n}\r\n\r\n// Format date\r\nconst formatDate = (dateString) => {\r\n  if (!dateString) return ''\r\n  return new Date(dateString).toLocaleDateString()\r\n}\r\n\r\n// Priority badge class\r\nconst priorityClass = (priority) => {\r\n  const classes = {\r\n    'High': 'bg-red-100 text-red-800',\r\n    'Medium': 'bg-yellow-100 text-yellow-800',\r\n    'Low': 'bg-green-100 text-green-800'\r\n  }\r\n  return classes[priority] || 'bg-gray-100 text-gray-800'\r\n}\r\n\r\n// Check if task should be disabled\r\nconst isTaskDisabled = (task) => {\r\n  return task.parent_task && task.parent_status !== 'Completed'\r\n}\r\n\r\n// Open task modal\r\nconst openTaskModal = (task) => {\r\n  selectedTask.value = { ...task }\r\n  showTaskModal.value = true\r\n}\r\n\r\n// Update task status\r\nconst handleStatusChange = async (task) => {\r\n  if (task.status === 'Completed') {\r\n    const confirmed = confirm('Are you sure you want to mark this task as Completed?');\r\n    if (!confirmed) {\r\n      task.status = previousStatus.value;\r\n      return;\r\n    }\r\n  }\r\n  await updateStatus(task);\r\n};\r\n\r\nconst updateStatus = async (task) => {\r\n  task.updating = true;\r\n  \r\n  try {\r\n    const resource = createResource({\r\n      url: 'client_management.client_management.doctype.activity.activity.update_activity_task_status',\r\n      method: 'POST',\r\n      params: {\r\n        activity_name: task.activity_docname,\r\n        task_name: task.name,\r\n        status: task.status\r\n      }\r\n    });\r\n    \r\n    await resource.submit();\r\n    await fetchTasks(); // Refresh the task list\r\n    \r\n    // Show success message\r\n    if (window.frappe) {\r\n      window.frappe.show_alert({\r\n        message: 'Task status updated successfully',\r\n        indicator: 'green'\r\n      }, 3);\r\n    }\r\n  } catch (error) {\r\n    console.error(\"Status update failed:\", error);\r\n    // Revert the status in UI\r\n    task.status = previousStatus.value;\r\n    if (window.frappe) {\r\n      window.frappe.show_alert({\r\n        message: 'Failed to update task status',\r\n        indicator: 'red'\r\n      }, 5);\r\n    }\r\n  } finally {\r\n    task.updating = false;\r\n  }\r\n};\r\n\r\n// Filter tasks\r\nconst filterTasks = () => {\r\n  if (!searchQuery.value) {\r\n    filteredTasks.value = [...tasks.value]\r\n    return\r\n  }\r\n  \r\n  const query = searchQuery.value.toLowerCase()\r\n  filteredTasks.value = tasks.value.filter(task => \r\n    task.activity_name.toLowerCase().includes(query) ||\r\n    task.task_name.toLowerCase().includes(query) ||\r\n    task.priority.toLowerCase().includes(query) ||\r\n    task.status.toLowerCase().includes(query)\r\n  )\r\n}\r\n\r\n// Fetch tasks\r\nconst fetchTasks = async () => {\r\n  loading.value = true\r\n  errorMessage.value = ''\r\n  \r\n  try {\r\n    const resource = createResource({\r\n      url: 'client_management.client_management.doctype.activity.activity.get_user_activity_tasks',\r\n      method: 'GET'\r\n    })\r\n    \r\n    const response = await resource.fetch()\r\n    \r\n    if (response.success) {\r\n      tasks.value = response.tasks.map(task => ({\r\n        ...task,\r\n        parent_status: task.parent_status || null,\r\n        updating: false // Initialize updating flag\r\n      }))\r\n      filteredTasks.value = [...tasks.value]\r\n    } else {\r\n      throw new Error(response.message || 'Failed to load tasks')\r\n    }\r\n  } catch (error) {\r\n    errorMessage.value = error.message || 'Failed to load tasks'\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// Initialize\r\nonMounted(() => {\r\n  fetchTasks()\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n\r\n.opacity-50 {\r\n  opacity: 0.5;\r\n  pointer-events: none;\r\n}\r\n\r\n.animate-spin {\r\n  animation: spin 1s linear infinite;\r\n}\r\n@keyframes spin {\r\n  from { transform: rotate(0deg); }\r\n  to { transform: rotate(360deg); }\r\n}\r\n</style>"],"names":["columns","statusOptions","tasks","ref","filteredTasks","loading","errorMessage","showTaskModal","selectedTask","previousStatus","showCommentModal","selectedCommentType","comments","newComment","attachment","fileInput","currentActivity","searchQuery","currentPage","pageSize","pageSizeOptions","totalPages","computed","paginatedTasks","startIndex","visiblePages","halfVisible","startPage","endPage","pages","i","watch","openCommentModal","task","commentType","__async","resetCommentForm","fetchComments","closeCommentModal","removeAttachment","isClient","onMounted","result","error","formatDateTime","dateString","activityName","activityNameToUse","commentTypeToUse","response","createResource","comment","__spreadProps","__spreadValues","handleFileUpload","e","file","submitComment","commentText","formData","_a","loadingComment","_c","_b","c","newCommentData","_e","_d","errorMsg","formatDate","priorityClass","priority","isTaskDisabled","handleStatusChange","updateStatus","fetchTasks","filterTasks","query","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","$event","_hoisted_7","_hoisted_8","_Fragment","_renderList","column","_toDisplayString","_hoisted_9","_normalizeClass","_hoisted_10","_hoisted_11","_createVNode","_component_router_link","_createTextVNode","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","option","_hoisted_18","_vModelSelect","_hoisted_19","_cache","_hoisted_20","_hoisted_21","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","page","_hoisted_35","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_40","_hoisted_41","_hoisted_42","_hoisted_43","_hoisted_44","_hoisted_45","_hoisted_46","_hoisted_47","_hoisted_48","_hoisted_49","_hoisted_50","_hoisted_51","_hoisted_52","_hoisted_53","_hoisted_54","_hoisted_55","_hoisted_56","_hoisted_57","$refs","_hoisted_58","_hoisted_59","_unref","Dialog","Button","_hoisted_60","_hoisted_61","_hoisted_62","_hoisted_63","_hoisted_64","_hoisted_65","_hoisted_66","_hoisted_67","_hoisted_68"],"mappings":"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"}