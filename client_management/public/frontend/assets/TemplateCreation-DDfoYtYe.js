var x=(C,o,n)=>new Promise((_,c)=>{var v=i=>{try{h(n.next(i))}catch(f){c(f)}},g=i=>{try{h(n.throw(i))}catch(f){c(f)}},h=i=>i.done?_(i.value):Promise.resolve(i.value).then(v,g);h((n=n.apply(C,o)).next())});import{h as S,r as b,a as r,i as V,t as T,b as p,j as $,d as t,u as s,F as I,k as F,w as k,o as m,I as y,g as w,l as U,m as P,n as D,p as B,c as z}from"./index-CK1KYSDl.js";const E={class:"max-w-3xl mx-auto p-6"},M={key:0,class:"mb-4 p-4 bg-green-100 text-green-700 rounded-md"},R={key:1,class:"mb-4 p-4 bg-red-100 text-red-700 rounded-md"},j={class:"card"},A={key:0,class:"absolute top-2 right-2"},L={class:"card-header"},O={class:"card-body"},W={key:0,class:"mb-4"},G={key:1,class:"mb-4"},H={class:"grid grid-cols-4 gap-4"},J={__name:"TemplateCreation",setup(C){const o=b({template_name:"",tasks:[{task_name:"",task_type:"",complete_within_days:1,from_date:"",to_date:"",description:"",is_child:!1,parent_task:null}]}),n=b(!1),_=b(!1),c=b(!1),v=b(""),g=()=>{o.value.tasks.push({task_name:"",task_type:"",complete_within_days:1,from_date:"",to_date:"",description:"",is_child:!1,parent_task:null})},h=l=>{o.value.tasks.splice(l,1)},i=(l,d)=>{l.is_child&&(l.from_date="",l.to_date="")},f=l=>o.value.tasks.slice(0,l),N=()=>x(this,null,function*(){_.value=!1,c.value=!1,v.value="",n.value=!0;try{const l=o.value.tasks.map((e,u)=>{const a={task_name:e.task_name,task_type:e.task_type,complete_within_days:e.complete_within_days,description:e.description,is_child:e.is_child||!1,parent_index:e.is_child?parseInt(e.parent_task):null};return e.is_child||(a.from_date=e.from_date,a.to_date=e.to_date),a});yield z({url:"client_management.client_management.doctype.template.template.create_template_with_task",method:"POST",params:{template_name:o.value.template_name,tasks:l}}).submit(),_.value=!0,o.value={template_name:"",tasks:[{task_name:"",task_type:"",complete_within_days:1,from_date:"",to_date:"",description:"",is_child:!1,parent_task:null}]},setTimeout(()=>{_.value=!1},3e3)}catch(l){c.value=!0,v.value=l.message||"Failed to create template"}finally{n.value=!1}});return(l,d)=>(m(),r("div",E,[_.value?(m(),r("div",M," Template created successfully! ")):V("",!0),c.value?(m(),r("div",R,T(v.value),1)):V("",!0),p("div",j,[d[3]||(d[3]=p("h2",{class:"card-header"},"Create New Template",-1)),p("form",{onSubmit:$(N,["prevent"]),class:"card-body"},[t(s(y),{label:"Template Name",modelValue:o.value.template_name,"onUpdate:modelValue":d[0]||(d[0]=e=>o.value.template_name=e),type:"text",required:"",class:"mb-4"},null,8,["modelValue"]),(m(!0),r(I,null,F(o.value.tasks,(e,u)=>(m(),r("div",{key:u,class:"card mb-4 relative"},[u>0?(m(),r("div",A,[t(s(U),{onClick:a=>h(u),variant:"ghost",size:"sm"},{default:k(()=>d[1]||(d[1]=[w(" Remove ")])),_:2,__:[1]},1032,["onClick"])])):V("",!0),p("h3",L,"Task "+T(u+1),1),p("div",O,[u>0?(m(),r("div",W,[t(s(P),{modelValue:e.is_child,"onUpdate:modelValue":a=>e.is_child=a,onChange:a=>i(e),label:"Is Child Task"},null,8,["modelValue","onUpdate:modelValue","onChange"])])):V("",!0),e.is_child?(m(),r("div",G,[t(s(D),{modelValue:e.parent_task,"onUpdate:modelValue":a=>e.parent_task=a,options:[{label:"Select Parent Task",value:""},...f(u).map((a,q)=>({label:a.task_name||`Task ${q+1}`,value:q}))],label:"Parent Task",required:""},null,8,["modelValue","onUpdate:modelValue","options"])])):V("",!0),t(s(y),{label:"Task Name",modelValue:e.task_name,"onUpdate:modelValue":a=>e.task_name=a,type:"text",required:"",class:"mb-4"},null,8,["modelValue","onUpdate:modelValue"]),p("div",H,[t(s(D),{class:"mt-3",modelValue:e.task_type,"onUpdate:modelValue":a=>e.task_type=a,options:[{label:"Task Type",value:""},{label:"Internal",value:"Internal"},{label:"Client",value:"Client"}],required:""},null,8,["modelValue","onUpdate:modelValue"]),t(s(y),{label:"Complete Within Days",modelValue:e.complete_within_days,"onUpdate:modelValue":a=>e.complete_within_days=a,type:"number",min:"1",required:""},null,8,["modelValue","onUpdate:modelValue"]),t(s(y),{label:"From Date",modelValue:e.from_date,"onUpdate:modelValue":a=>e.from_date=a,type:"date",disabled:e.is_child,required:!e.is_child},null,8,["modelValue","onUpdate:modelValue","disabled","required"]),t(s(y),{label:"To Date",modelValue:e.to_date,"onUpdate:modelValue":a=>e.to_date=a,type:"date",disabled:e.is_child,required:!e.is_child},null,8,["modelValue","onUpdate:modelValue","disabled","required"])]),t(s(B),{label:"Description",modelValue:e.description,"onUpdate:modelValue":a=>e.description=a,rows:"3"},null,8,["modelValue","onUpdate:modelValue"])])]))),128)),t(s(U),{type:"button",onClick:g,variant:"outline",class:"w-full mb-4"},{default:k(()=>d[2]||(d[2]=[w(" + Add Task ")])),_:1,__:[2]}),t(s(U),{type:"submit",variant:"solid",theme:"gray",size:"sm",loading:n.value,class:"w-full"},{default:k(()=>[w(T(n.value?"Saving...":"Create Template"),1)]),_:1},8,["loading"])],32)])]))}},X=S(J,[["__scopeId","data-v-311fa8fb"]]);export{X as default};
//# sourceMappingURL=TemplateCreation-DDfoYtYe.js.map
